// ==UserScript==
// @name         GenLite-snwhd
// @namespace    GenLite-snwhd
// @version      0.2.26
// @description  try to take over the world!
// @author       https://github.com/Retoxified/GenLite/blob/main/CREDITS.md
// @match        https://play.genfanad.com/play/
// @icon         https://www.google.com/s2/favicons?sz=64&domain=genfanad.com
// @run-at       document-start
// ==/UserScript==

/*
    Copyright (C) 2022-2023 Retoxified, dpeGit, snwhd, BonesdogNardwe, KKonaOG, FrozenReality, Xortrox
*/
/*
    This file is part of GenLite.
    GenLite is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
    GenLite is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
    You should have received a copy of the GNU General Public License along with Foobar. If not, see <https://www.gnu.org/licenses/>.
*/

(()=>{var __webpack_modules__={832:e=>{"use strict";e.exports=JSON.parse('{"type":"release","repoOwner":"snwhd"}')}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}var __webpack_exports__={};(()=>{var githubConfig=__webpack_require__(832),LoaderDatabaseVersion=1,LoaderDatabaseName="GenLiteLoaderDatabase",GenfanadStoreName="genfanad.client",GenliteStoreName="genlite.client";function setupIDB(){var e=window.indexedDB.open(LoaderDatabaseName,LoaderDatabaseVersion);e.onupgradeneeded=function(t){var n=e.result;n.objectStoreNames.contains(GenfanadStoreName)||n.createObjectStore(GenfanadStoreName,{keyPath:"key",autoIncrement:!0}).createIndex("indexKey","key",{unique:!0});n.objectStoreNames.contains(GenliteStoreName)||n.createObjectStore(GenliteStoreName,{keyPath:"key",autoIncrement:!0}).createIndex("indexKey","key",{unique:!0})},e.onsuccess=function(e){installGenlite()},e.onerror=function(e){console.error("Error initializing Genlite IDB",e)}}function getGenliteFromIDB(e){var t=window.indexedDB.open(LoaderDatabaseName,LoaderDatabaseVersion);t.onsuccess=function(n){var a=t.result.transaction(GenliteStoreName,"readonly").objectStore(GenliteStoreName),s=a.count();s.onsuccess=function(){0===s.result?e(null):a.openCursor(null,"prev").onsuccess=function(t){e(t.target.result.value)}}}}function saveGenliteToIDB(e,t,n,a){var s=window.indexedDB.open(LoaderDatabaseName,LoaderDatabaseVersion);s.onsuccess=function(o){var i=s.result.transaction(GenliteStoreName,"readwrite").objectStore(GenliteStoreName);i.clear().onsuccess=function(s){i.put({src:e,version:t,timestamp:n}).onsuccess=function(e){a()}}}}function getGenfanadFromIDB(e){var t=window.indexedDB.open(LoaderDatabaseName,LoaderDatabaseVersion);t.onsuccess=function(n){var a=t.result.transaction(GenfanadStoreName,"readonly").objectStore(GenfanadStoreName),s=a.count();s.onsuccess=function(){0===s.result?e(null):a.openCursor(null,"prev").onsuccess=function(t){e(t.target.result.value)}}}}function saveGenfanadToIDB(e,t){var n=window.indexedDB.open(LoaderDatabaseName,LoaderDatabaseVersion);n.onsuccess=function(a){var s=n.result.transaction(GenfanadStoreName,"readwrite").objectStore(GenfanadStoreName);s.clear().onsuccess=function(n){s.put({src:e,timestamp:t})}}}function setupGenlite(){getGenliteFromIDB((function(genlite){var releasesUrl,distUrl;if("release"==githubConfig.type)releasesUrl="https://api.github.com/repos/".concat(githubConfig.repoOwner,"/GenLite/releases/latest"),distUrl="https://raw.githubusercontent.com/".concat(githubConfig.repoOwner,"/GenLite/release/dist/genliteClient.user.js");else{var release=new XMLHttpRequest;release.open("GET","https://api.github.com/repos/".concat(githubConfig.repoOwner,"/GenLite/releases"),!1),release.setRequestHeader("Accept","application/vnd.github.v3+json"),release.send();var releasesArray=eval(release.responseText);releasesUrl=releasesArray[0].url,distUrl="https://raw.githubusercontent.com/".concat(githubConfig.repoOwner,"/GenLite/beta/dist/genliteClient.user.js")}var xhrGenliteModified=new XMLHttpRequest;xhrGenliteModified.open("GET",releasesUrl,!1),xhrGenliteModified.setRequestHeader("Accept","application/vnd.github.v3+json"),xhrGenliteModified.send();var genliteAPIRespose=JSON.parse(xhrGenliteModified.responseText),genliteModifiedDate=genliteAPIRespose.published_at,genliteVersion=genliteAPIRespose.tag_name,genliteLastModified;genliteLastModified=null==genliteModifiedDate||null==genliteModifiedDate?new Date(0):new Date(genliteModifiedDate);var needsUpdate=null===genlite;if(!needsUpdate){var genliteUpdateTimestampDate=new Date(genlite.timestamp);needsUpdate=genliteLastModified>genliteUpdateTimestampDate}needsUpdate?document.addEventListener("DOMContentLoaded",(function(){document.documentElement.innerHTML="";var e=document.createElement("link");e.rel="stylesheet",e.href="https://fonts.googleapis.com/css2?family=Acme&display=swap",document.head.appendChild(e),document.body.style.fontFamily="Acme, sans-serif",document.documentElement.style.backgroundColor="black";var t=document.createElement("div");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.backgroundImage="url(https://i.imgur.com/KutJ1gO.png)",t.style.zIndex="99",t.style.filter="blur(5px)",t.style.backgroundSize="cover",t.style.backgroundRepeat="no-repeat",t.style.backgroundPosition="center",document.body.appendChild(t);var n=document.createElement("div");n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.width="100%",n.style.height="100%",n.style.backgroundColor="black",n.style.opacity="0.5",n.style.filter="blur(5px)",t.appendChild(n);var a=document.createElement("div");a.id="genlite-confirm-modal",a.style.position="fixed",a.style.top="50%",a.style.left="50%",a.style.width="40%",a.style.transform="translate(-50%, -50%)",a.style.zIndex="100",document.documentElement.appendChild(a);var s=document.createElement("div");s.id="genlite-confirm-header",s.style.backgroundImage='url("https://genfanad-static.s3.us-east-2.amazonaws.com/versioned/0.120/data_client/img/new_ux/login_screen_images/generic_modal_top.png")',s.style.backgroundSize="100%, 100%",s.style.width="100%",s.style.aspectRatio="2106/310",a.appendChild(s);var o=document.createElement("div");o.style.backgroundImage='url("https://genfanad-static.s3.us-east-2.amazonaws.com/versioned/0.120/data_client/img/new_ux/login_screen_images/modal_title.png")',o.style.position="fixed",o.style.width="40%",o.style.aspectRatio="632/120",o.style.backgroundSize="100%, 100%",o.style.top="0",o.style.left="50%",o.style.transform="translate(-50%, -25%)",o.style.textAlign="center",o.style.textShadow="-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000",o.style.fontFamily="acme,times new roman,Times,serif",o.style.fontSize="1.5rem",o.style.color="white",o.style.overflow="hidden",o.style.display="flex",o.style.justifyContent="center",o.style.alignContent="center",o.style.flexDirection="column",o.innerText="GenLite is out of date!",s.appendChild(o);var i=document.createElement("div");i.id="genlite-confirm-body",i.style.backgroundImage='url("https://genfanad-static.s3.us-east-2.amazonaws.com/versioned/0.120/data_client/img/new_ux/login_screen_images/generic_modal_mid_and_bottom.png")',i.style.backgroundSize="100%, 100%",i.style.width="100%",i.style.aspectRatio="2104/1316",i.style.textAlign="center",i.style.textShadow="-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000",i.style.fontFamily="acme,times new roman,Times,serif",i.style.fontSize="1.5rem",i.style.color="white",a.appendChild(i);var l=document.createElement("div");l.style.width="90%",l.style.height="75%",l.style.margin="auto",l.style.overflowY="scroll",i.appendChild(l);var r=document.createElement("span");r.style.display="inline-block",r.style.width="75%",r.style.textAlign="center",r.style.paddingBottom="2em",r.innerText="A new version of GenLite is available. It is highly recommended that you update to the latest version, as older versions may not work properly. If you choose to continue with this version, you may experience issues or bugs that have been fixed in the latest version. You will only be notified of this update once.",l.appendChild(r);var d=document.createElement("div");d.style.backgroundImage='url("https://genfanad-static.s3.us-east-2.amazonaws.com/versioned/0.120/data_client/img/new_ux/login_screen_images/return_button.png")',d.style.backgroundSize="100%, 100%",d.style.width="15%",d.style.aspectRatio="131/52",d.style.position="fixed",d.style.top="100%",d.style.left="40%",d.style.transform="translate(-50%, -175%)",d.style.display="flex",d.style.justifyContent="center",d.style.alignContent="center",d.style.flexDirection="column",d.style.cursor="pointer",d.innerText="Update Now",d.onclick=function(e){var t=new XMLHttpRequest;t.open("GET",distUrl),t.onload=function(){200==t.status&&saveGenliteToIDB(t.responseText,genliteVersion,genliteLastModified.toString(),(function(){window.location.reload()}))},t.send()},l.appendChild(d);var c=document.createElement("div");c.style.backgroundImage='url("https://genfanad-static.s3.us-east-2.amazonaws.com/versioned/0.120/data_client/img/new_ux/crafting/crafting_2/make_all.png")',c.style.backgroundSize="100%, 100%",c.style.width="15%",c.style.aspectRatio="188/72",c.style.position="fixed",c.style.top="100%",c.style.left="60%",c.style.transform="translate(-50%, -175%)",c.style.display="flex",c.style.justifyContent="center",c.style.alignContent="center",c.style.flexDirection="column",c.style.cursor="pointer",c.innerText="Remind Me Later",c.onclick=function(e){a.remove()},l.appendChild(c)})):(window.addEventListener("load",(function(){var e=document.createElement("p");e.innerText="GenLite Version:"+genlite.version,e.id="genlite-version",e.style.padding="0",e.style.margin="0",document.getElementById("loginversion").appendChild(e)})),eval(genlite.src))}))}function setupGenfanad(){getGenfanadFromIDB((function(e){var t=new XMLHttpRequest;t.open("HEAD","https://play.genfanad.com/play/js/client.js",!1),t.setRequestHeader("Cache-Control","no-cache, no-store, must-revalidate"),t.send();var n,a=t.getResponseHeader("Last-Modified");n=null==a||null==a?new Date(0):new Date(a);var s=null==e?void 0:e.src;if(null===e||n>new Date(e.timestamp)){var o=new XMLHttpRequest;o.open("GET","https://play.genfanad.com/play/js/client.js"),o.onload=function(){200==o.status?saveGenfanadToIDB(s=(s=(s=o.responseText).replace(/import.meta.url/g,'("https://play.genfanad.com/play/js/client.js")')).substring(0,s.length-5)+"; document.client = {};document.client.get = function(a) {return eval(a);};document.client.set = function(a, b) {eval(a + ' = ' + b);};"+s.substring(s.length-5)+"//# sourceURL=client.js",n.toString()):console.error("GenFanad Client.js failed to load. Status: "+o.status)},o.send()}}))}function installGenlite(){setupGenlite(),setupGenfanad()}"GenFanad.Client"in localStorage&&localStorage.removeItem("GenFanad.Client"),"GenLite.Client"in localStorage&&localStorage.removeItem("GenLite.Client"),"indexedDB"in window?setupIDB():console.error("GenLite is not supported in this browser (no IndexedDB)")})()})();